<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- iOS Safari -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<!-- Chrome, Firefox OS and Opera Status Bar Color -->
<meta name="theme-color" content="#FFFFFF">
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css">
<link rel="stylesheet" type="text/css"
  href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/themes/prism.min.css">
<link rel="stylesheet" type="text/css" href="css/SourceSansPro.css">
<link rel="stylesheet" type="text/css" href="css/theme.css">
<link rel="stylesheet" type="text/css" href="css/notablog.css">
<!-- Favicon -->

  <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;📖&lt;/text&gt;&lt;/svg&gt;">

<style>
  :root {
    font-size: 20px;
  }
</style>
  <title>Java的运行时数据区域&nbsp;|&nbsp;Junying Shao&#39;s Blog</title>
  <meta property="og:type" content="blog">
  <meta property="og:title" content="Java的运行时数据区域">
  
  
    <meta property="og:image" content="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;♥️&lt;/text&gt;&lt;/svg&gt;">
  
  <style>
    .DateTagBar {
      margin-top: 1.0rem;
    }
  </style>
</head>

<body>
  <nav class="Navbar">
  <a href="index.html">
    <div class="Navbar__Btn">
      
        <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;📖&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
      
      <span>Home</span>
    </div>
  </a>
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <span class="Navbar__Delim">&centerdot;</span>
      <a href="about.html">
        <div class="Navbar__Btn">
          
            <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;😀&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
          
          <span>About</span>
        </div>
      </a>
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
</nav>
  <header class="Header">
    
      <div class="Header__Cover">
        <img src="https://www.notion.so/images/page-cover/met_william_morris_1878.jpg">
      </div>
    
    <div class="Header__Spacer ">
    </div>
    
      <div class="Header__Icon">
        <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;♥️&lt;/text&gt;&lt;/svg&gt;"></span>
      </div>
    
    <h1 class="Header__Title">Java的运行时数据区域</h1>
    
      <div class="DateTagBar">
        
          <span class="DateTagBar__Item DateTagBar__Date">Posted on Wed, Dec 22, 2021</span>
        
        
          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--blue">
            <a href="tag/Java.html">Java</a>
          </span>
        
          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--default">
            <a href="tag/JVM.html">JVM</a>
          </span>
        
      </div>
    
  </header>
  <article id="https://www.notion.so/5ca91de478654802aad6c931949cf0d8" class="PageRoot"><ul id="https://www.notion.so/832f79be200e4887a4af563a54ce9eec" class="ColorfulBlock ColorfulBlock--ColorGray TableOfContents"><li class="TableOfContents__Item"><a href="#https://www.notion.so/517b28fe6afa401299f3ee2ea9a4d7e6"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">运行时数据区域图示</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/9d7b4a264691444f9e06acc792081b56"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">线程</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/49252deab53544568a8961bee57fb1c7"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">虚拟机栈</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/2776773bf69f44c5beeb0bab4fb7c3fc"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">出现的原因</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/29b19490a85e419c96299813e30b18a9"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">虚拟机栈的常见异常</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/96c35d4f38d049e9a13a5632bb72d102"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">设置虚拟机栈的大小</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/98e3608d3839488d9e8516070b01081b"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">栈桢</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/1c396c32a8a0484d959b2f5c1acaac99"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">栈桢的内部结构</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/b10ebc0f7b794f079f2e7e708493d59e"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">局部变量表</span></span></div></a></li></ul><h1 id="https://www.notion.so/517b28fe6afa401299f3ee2ea9a4d7e6" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/517b28fe6afa401299f3ee2ea9a4d7e6"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">运行时数据区域图示</span></span></h1><div id="https://www.notion.so/0c67d46e63bb465da75e586e793f0bf6" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F82524bfe-9a08-4ed0-935d-ed58da31080d%2FUntitled.png?width=768&amp;table=block&amp;id=0c67d46e-63bb-465d-a75e-586e793f0bf6"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F82524bfe-9a08-4ed0-935d-ed58da31080d%2FUntitled.png?width=768&amp;table=block&amp;id=0c67d46e-63bb-465d-a75e-586e793f0bf6" style="width:768px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/7941d9b01e374ff8a8592e93c67e05d1" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Java中的Runtime对象，每个JVM只有一份，对应于运行时数据区。</span></span></p></div><h2 id="https://www.notion.so/9d7b4a264691444f9e06acc792081b56" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/9d7b4a264691444f9e06acc792081b56"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">线程</span></span></h2><div id="https://www.notion.so/be87eeddd1fb447890ec3923e6a792f8" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">在HotSpot JVM中，每个线程都与操作系统的本地线程直接映射。 </span><span class="SemanticString"><span class="SemanticString__Fragment SemanticString__Fragment--Resource"><a href=""><span class="SemanticStringArray"><span class="SemanticString">Unknown Page</span></span></a></span></span><span class="SemanticString"> </span></span></p></div><h1 id="https://www.notion.so/49252deab53544568a8961bee57fb1c7" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/49252deab53544568a8961bee57fb1c7"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">虚拟机栈</span></span></h1><h2 id="https://www.notion.so/2776773bf69f44c5beeb0bab4fb7c3fc" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/2776773bf69f44c5beeb0bab4fb7c3fc"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">出现的原因</span></span></h2><div id="https://www.notion.so/7fdcf19a26844a0eafdb459c5ebbd3f4" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">由于跨平台性的设计，Java的指令都是根据栈来设计的，不同平台CPU架构不同，所以不能基于寄存器设计。</span></span></p></div><div id="https://www.notion.so/ae395faf66b646c3a7bcf037ec8a6f43" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">优点</strong></span><span class="SemanticString">：跨平台、指令集小、编译器容易实现。</span></span></p></div><div id="https://www.notion.so/f235a478dc7846d38dd58825a8629c18" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">缺点</strong></span><span class="SemanticString">：性能比较差，实现同样的功能需要更多的指令。</span></span></p></div><h2 id="https://www.notion.so/29b19490a85e419c96299813e30b18a9" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/29b19490a85e419c96299813e30b18a9"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">虚拟机栈的常见异常</span></span></h2><div id="https://www.notion.so/fb8451bd67334efeb40dc1ef487dc069" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">参考链接：</span></span></p></div><div id="https://www.notion.so/5e8dd0a4466e449a97d8023fbb09c0ed" class="Bookmark"><a href="https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-2.html#jvms-2.5.2"><h5 class="Bookmark__Title">Chapter 2. The Structure of the Java Virtual Machine</h5><p class="Bookmark__Desc">This document specifies an abstract machine. It does not describe any particular implementation of the Java Virtual Machine. To implement the Java Virtual Machine correctly, you need only be able to read the class file format and correctly perform the operations specified therein.</p><p class="Bookmark__Link">https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-2.html#jvms-2.5.2</p></a></div><pre id="https://www.notion.so/5acd96e939ca4c9294510d3639ed16a2" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span>The following exceptional conditions are associated with Java Virtual Machine stacks:

If the computation in a thread requires a larger Java Virtual Machine stack than is permitted, the Java Virtual Machine throws a StackOverflowError.

If Java Virtual Machine stacks can be dynamically expanded, and expansion is attempted but insufficient memory can be made available to effect the expansion, or if insufficient memory can be made available to create the initial Java Virtual Machine stack for a new thread, the Java Virtual Machine throws an OutOfMemoryError.</span></span></span></code></pre><ol class="NumberedListWrapper"><li id="https://www.notion.so/eea932e6ee1d4eb486cde2ea79079bff" class="NumberedList" value="1"><span class="SemanticStringArray"><span class="SemanticString">如果采用固定大小的Java虚拟机栈，并且线程申请的栈容量超过Java虚拟机允许的最大容量，Java虚拟机将抛出</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">StackOverFlowError</strong></span><span class="SemanticString">异常。</span></span></li><li id="https://www.notion.so/6931122d8c3d4d9e9803b74696496f52" class="NumberedList" value="2"><span class="SemanticStringArray"><span class="SemanticString">如果Java虚拟机栈可以动态扩展，并且</span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorRed">在尝试扩展时无法申请足够的内存</mark></span><span class="SemanticString">，或者</span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorRed">在创建新线程时没有足够的内存创建虚拟机栈</mark></span><span class="SemanticString">，Java虚拟机将抛出</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">OutOfMemoryError</strong></span><span class="SemanticString">异常。</span></span></li></ol><h2 id="https://www.notion.so/96c35d4f38d049e9a13a5632bb72d102" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/96c35d4f38d049e9a13a5632bb72d102"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">设置虚拟机栈的大小</span></span></h2><div id="https://www.notion.so/29224dd47f7b404c825b4f65238d88b2" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">执行</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">java</code></span><span class="SemanticString">命令时，可以使用</span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">-Xss</code></span><span class="SemanticString">指定虚拟机栈的大小。</span></span></p></div><h2 id="https://www.notion.so/98e3608d3839488d9e8516070b01081b" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/98e3608d3839488d9e8516070b01081b"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">栈桢</span></span></h2><h3 id="https://www.notion.so/1c396c32a8a0484d959b2f5c1acaac99" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/1c396c32a8a0484d959b2f5c1acaac99"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">栈桢的内部结构</span></span></h3><div id="https://www.notion.so/23e01563f7734555aeb75e97db77c31b" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fa553a2f9-537c-41c5-863a-17c2c54ec30d%2FUntitled.png?width=816&amp;table=block&amp;id=23e01563-f773-4555-aeb7-5e97db77c31b"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fa553a2f9-537c-41c5-863a-17c2c54ec30d%2FUntitled.png?width=816&amp;table=block&amp;id=23e01563-f773-4555-aeb7-5e97db77c31b" style="width:816px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/8811c9b82f4e4012947e67b6a64bcaf5" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">局部变量表</strong></span><span class="SemanticString">。存储方法参数和定义在方法体内的局部变量。</span></span></li><li id="https://www.notion.so/129fab8022604fbbb248f01b309d8581" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">操作数栈</strong></span><span class="SemanticString">。（表达式栈）</span></span></li><li id="https://www.notion.so/bc266dd42aed4be596e0fb68d40fb29f" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">动态链接</strong></span><span class="SemanticString">。（指向运行时常量池的方法引用）</span></span></li><li id="https://www.notion.so/b25420af0ddf462cbf79b3cbd2b95e86" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">方法返回地址</strong></span><span class="SemanticString">。（方法正常退出或异常退出的定义）</span></span></li><li id="https://www.notion.so/4a2020d0e80742528e65f79a04f07f9d" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">一些附加信息。</span></span></li></ul><h3 id="https://www.notion.so/b10ebc0f7b794f079f2e7e708493d59e" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/b10ebc0f7b794f079f2e7e708493d59e"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">局部变量表</span></span></h3><div id="https://www.notion.so/8d759b008f854b08a78b664de7c5c3a5" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">局部变量表是一个数字数组，主要用于存储</span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorRed">方法参数</mark></span><span class="SemanticString">和</span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorRed">定义在方法体内的局部变量</mark></span><span class="SemanticString">。这些数据类型包括</span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorRed">基本数据类型</mark></span><span class="SemanticString">、</span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorRed">对象引用</mark></span><span class="SemanticString">、</span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorRed">返回地址类型</mark></span><span class="SemanticString">。</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/7e50c4776b90424c810530e747b26bca" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">单个变量可以存储类型为boolean、float、int、char、short、byte、reference、returnAddress的数据，一对变量可以用来存储类型为double、long类型的数据。</span></span></li><li id="https://www.notion.so/aebd0e7d87ba4d8db2ed03263eaf3067" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">JVM通过数组下标来读写变量，占用两个变量的数据（long、double类型）通过</span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorRed">位置靠前变量的下标</mark></span><span class="SemanticString">寻址。</span></span></li><li id="https://www.notion.so/bb64409126dd4b41b51be75f65199c35" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">局部变量表的大小是在编译期确定下来的，并保存在class文件中。在运行期间不会改变。</span></span></li><li id="https://www.notion.so/317f76f9ff5a4f7099f9b979c2b26be3" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">JVM在进行</span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorRed">方法调用</mark></span><span class="SemanticString">时使用</span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorRed">局部变量表</mark></span><span class="SemanticString">传递参数。对于</span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorRed">静态方法</mark></span><span class="SemanticString">，参数在</span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorRed">局部变量表</mark></span><span class="SemanticString">中的下标从0开始；对于</span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorRed">非静态方法</mark></span><span class="SemanticString">，参数在</span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorRed">局部变量表</mark></span><span class="SemanticString">中的下标从1开始，位置0保存</span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorRed">当前对象的引用</mark></span><span class="SemanticString">。（Java中是变量this）</span></span></li><li id="https://www.notion.so/61e49f6e60f245d4891a12c5b3a9629a" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">局部变量表中的槽位是</span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorRed">可复用的</mark></span><span class="SemanticString">，只要两个变量的作用域不重叠，那么他们可以共用同一个槽位。</span></span></li></ul><div id="https://www.notion.so/65966ee74b2f45069661f42bb39dd03b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">局部变量和成员变量的对比</strong></span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/e65644ff93604797b17ccf92a9a06bf3" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorRed">成员变量</mark></span><span class="SemanticString">指的是声明在</span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorRed">类</mark></span><span class="SemanticString">中的变量，包含</span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorRed">类变量和实例变量</mark></span><span class="SemanticString">。这两者在使用之前都经历过</span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorRed">默认初始化赋值</mark></span><span class="SemanticString">。</span></span><ul class="BulletedListWrapper"><li id="https://www.notion.so/2329c5c7e7a944a988f150cc984b6adb" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">类变量：在</span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorRed">链接中的准备阶段</mark></span><span class="SemanticString">被赋零值，在</span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorRed">初始化阶段</mark></span><span class="SemanticString">被赋具体的值。</span></span></li><li id="https://www.notion.so/a08989af3bf74ed2ab76e9b333da7b41" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">实例变量：随着对象的创建，会在</span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorRed">堆空间</mark></span><span class="SemanticString">分配实例变量的空间，并执行默认赋值。</span></span></li></ul></li><li id="https://www.notion.so/558eb7bfaac14c648854af0be6210743" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorRed">局部变量</mark></span><span class="SemanticString">指的是定义在</span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorRed">方法</mark></span><span class="SemanticString">内的变量，必须进行显式赋值，否则编译不通过。</span></span></li></ul><div id="https://www.notion.so/83468e19f7f149e18ec82f2a29879225" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Class文件中的局部变量表</strong></span></span></p></div><div id="https://www.notion.so/8384ea484011474ca774b295dc842698" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">项目结构如下图所示</span></span></p></div><pre id="https://www.notion.so/71e4ee8b0da841c8900ffeba7946404c" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span>.
├── src
│   └── Main.java
└── target</span></span></span></code></pre><div id="https://www.notion.so/b582795fbab64404b7d0291fb960b8e6" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">其中Main.java文件内容如下所示：</span></span></p></div><pre id="https://www.notion.so/f25436f5f6174a3d83398bd0ad0a4f5e" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token class-name">Main</span><span class="token punctuation">(</span><span class="token keyword">int</span> num<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> str <span class="token operator">=</span> <span class="token string">"11"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></span></span></span></code></pre><div id="https://www.notion.so/cd855c9044714215a393a276c4c2b21b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">首先执行javac命令生成class文件</span></span></p></div><pre id="https://www.notion.so/303c59e3ce6641d5b0238a9c5dd03afa" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token comment"># 这里-g 表示生成所有的debug文件，否则class文件中不包含 局部变量表的详细信息</span>
javac -g src/Main.java -d target</span></span></span></code></pre><div id="https://www.notion.so/883937bc66f54974812f75799e8e09c3" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">之后解析class文件并查看局部变量表信息</span></span></p></div><pre id="https://www.notion.so/188525b05e6a49c0a6286f8301ab877a" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span>javap -v -cp target Main</span></span></span></code></pre><div id="https://www.notion.so/da374b87100b4eb3983a63716128db38" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">得到的内容如下所示</span></span></p></div><pre id="https://www.notion.so/8ca10c8814a746cd8d77886351648d9e" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span>Classfile /Users/shaojunying/WorkSpace/JVMLearning/1_RuntimeMemoryArea/target/Main.class
  Last modified 2021年12月25日; size 454 bytes
  SHA-256 checksum 1728b7c9120d0cd4679dc99ce011ef33eea156e5e5efa305ead65a709e974510
  Compiled from &quot;Main.java&quot;
public class Main
  minor version: 0
  major version: 61
  flags: (0x0021) ACC_PUBLIC, ACC_SUPER
  this_class: #9                          // Main
  super_class: #2                         // java/lang/Object
  interfaces: 0, fields: 0, methods: 2, attributes: 1
Constant pool:
   #1 = Methodref          #2.#3          // java/lang/Object.&quot;&lt;init&gt;&quot;:()V
   #2 = Class              #4             // java/lang/Object
   #3 = NameAndType        #5:#6          // &quot;&lt;init&gt;&quot;:()V
   #4 = Utf8               java/lang/Object
   #5 = Utf8               &lt;init&gt;
   #6 = Utf8               ()V
   #7 = String             #8             // 11
   #8 = Utf8               11
   #9 = Class              #10            // Main
  #10 = Utf8               Main
  #11 = Utf8               (I)V
  #12 = Utf8               Code
  #13 = Utf8               LineNumberTable
  #14 = Utf8               LocalVariableTable
  #15 = Utf8               this
  #16 = Utf8               LMain;
  #17 = Utf8               num
  #18 = Utf8               I
  #19 = Utf8               main
  #20 = Utf8               ([Ljava/lang/String;)V
  #21 = Utf8               args
  #22 = Utf8               [Ljava/lang/String;
  #23 = Utf8               str
  #24 = Utf8               Ljava/lang/String;
  #25 = Utf8               SourceFile
  #26 = Utf8               Main.java
{
  public Main(int);
    descriptor: (I)V
    flags: (0x0001) ACC_PUBLIC
    Code:
      stack=1, locals=2, args_size=2
         0: aload_0
         1: invokespecial #1                  // Method java/lang/Object.&quot;&lt;init&gt;&quot;:()V
         4: return
      LineNumberTable:
        line 3: 0
        line 5: 4
      LocalVariableTable:
        Start  Length  Slot  Name   Signature
            0       5     0  this   LMain;
            0       5     1   num   I

  public static void main(java.lang.String[]);
    descriptor: ([Ljava/lang/String;)V
    flags: (0x0009) ACC_PUBLIC, ACC_STATIC
    Code:
      stack=1, locals=3, args_size=1
         0: iconst_1
         1: istore_1
         2: ldc           #7                  // String 11
         4: astore_2
         5: return
      LineNumberTable:
        line 8: 0
        line 9: 2
        line 10: 5
      LocalVariableTable:
        Start  Length  Slot  Name   Signature
            0       6     0  args   [Ljava/lang/String;
            2       4     1   num   I
            5       1     2   str   Ljava/lang/String;
}
SourceFile: &quot;Main.java&quot;</span></span></span></code></pre><div id="https://www.notion.so/962de09e4e3d431e984bfb3fc4d241c5" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">可以看到Code中的locals记录了</span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorRed">局部变量表</mark></span><span class="SemanticString">的大小，而LocalVariableTable则详细记录了</span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorRed">局部变量表</mark></span><span class="SemanticString">中存放的内容。</span></span></p></div><div id="https://www.notion.so/3c0796dbb096494989626e4c54432afd" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div></article>
  <script src="https://utteranc.es/client.js"
    repo="shaojunying/shaojunying.github.io"
    issue-term="title"
    label="Comment"
    theme="github-light"
    crossorigin="anonymous"
    async>
  </script>
  <footer class="Footer">
  <div>&copy; Junying Shao&#39;s Blog 2019-2021</div>
  <div>&centerdot;</div>
  <div>Powered by <a href="https://github.com/dragonman225/notablog" target="_blank"
      rel="noopener noreferrer">Notablog</a>.
  </div>
</footer>
</body>

</html>