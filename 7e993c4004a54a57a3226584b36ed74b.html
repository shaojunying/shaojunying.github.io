<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- iOS Safari -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<!-- Chrome, Firefox OS and Opera Status Bar Color -->
<meta name="theme-color" content="#FFFFFF">
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css">
<link rel="stylesheet" type="text/css"
  href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/themes/prism.min.css">
<link rel="stylesheet" type="text/css" href="css/SourceSansPro.css">
<link rel="stylesheet" type="text/css" href="css/theme.css">
<link rel="stylesheet" type="text/css" href="css/notablog.css">
<!-- Favicon -->

  <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;📖&lt;/text&gt;&lt;/svg&gt;">

<style>
  :root {
    font-size: 20px;
  }
</style>
  <title>一台计算机一秒可以发出多少请求&nbsp;|&nbsp;Junying Shao&#39;s Blog</title>
  <meta property="og:type" content="blog">
  <meta property="og:title" content="一台计算机一秒可以发出多少请求">
  
  
    <meta property="og:image" content="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;🙀&lt;/text&gt;&lt;/svg&gt;">
  
  <style>
    .DateTagBar {
      margin-top: 1.0rem;
    }
  </style>
</head>

<body>
  <nav class="Navbar">
  <a href="index.html">
    <div class="Navbar__Btn">
      
        <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;📖&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
      
      <span>Home</span>
    </div>
  </a>
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <span class="Navbar__Delim">&centerdot;</span>
      <a href="about.html">
        <div class="Navbar__Btn">
          
            <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;😀&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
          
          <span>About</span>
        </div>
      </a>
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
</nav>
  <header class="Header">
    
    <div class="Header__Spacer Header__Spacer--NoCover">
    </div>
    
      <div class="Header__Icon">
        <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;🙀&lt;/text&gt;&lt;/svg&gt;"></span>
      </div>
    
    <h1 class="Header__Title">一台计算机一秒可以发出多少请求</h1>
    
      <div class="DateTagBar">
        
        
          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--pink">
            <a href="tag/实践.html">实践</a>
          </span>
        
          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--red">
            <a href="tag/计算机网络.html">计算机网络</a>
          </span>
        
          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--gray">
            <a href="tag/HTTP.html">HTTP</a>
          </span>
        
          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--purple">
            <a href="tag/多线程.html">多线程</a>
          </span>
        
      </div>
    
  </header>
  <article id="https://www.notion.so/7e993c4004a54a57a3226584b36ed74b" class="PageRoot"><ul id="https://www.notion.so/9c97a83ea18746d488e1ebf3afb4172e" class="ColorfulBlock ColorfulBlock--ColorGray TableOfContents"><li class="TableOfContents__Item"><a href="#https://www.notion.so/8ddfe183ace14ec9aeda372c39eb3743"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">问题描述</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/1ce8d7d328b74ba9b25a3a6f952e8fb1"><div style="margin-left:0px"><span class="SemanticStringArray"><span class="SemanticString">实验</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/d8ed031f68c84d6ab0a48c6d5a8457c6"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">服务端</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/1d5536195c9e48f1be7c8310f0ac792f"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">服务端配置</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/3957cbfc2d574675909be8c28c877aaa"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">服务端代码</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/e29484a32dce430bad2f5cb633df007e"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">客户端</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/1ccbd00025544fe1b89d089d12e428ee"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">普通单线程</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/9ccdbb8332e347a1a605cd860853617f"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">普通多线程</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/8ab8a1d6caeb4453af881c7bc70fa3a7"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">线程池</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/ae8d3f0b529a4e049a7ef81c6e1c5ae6"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">线程池+</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">测试百度</strong></span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/b5cbbb2960e3415593f7adb699ed45d8"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">线程池+socket构造请求</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/cb4646b6764648cabc4073b5c59ea45d"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">仅使用socket（不使用多线程）</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/7c717135188f4105958e31b2cf681c51"><div style="margin-left:48px"><span class="SemanticStringArray"><span class="SemanticString">在一个socket中发送多个HTTP请求</span></span></div></a></li><li class="TableOfContents__Item"><a href="#https://www.notion.so/09a65e64ad2948e287592fa6a9490b23"><div style="margin-left:24px"><span class="SemanticStringArray"><span class="SemanticString">总结</span></span></div></a></li></ul><h1 id="https://www.notion.so/8ddfe183ace14ec9aeda372c39eb3743" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/8ddfe183ace14ec9aeda372c39eb3743"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">问题描述</span></span></h1><div id="https://www.notion.so/91789af4592243a7b05e2e3114ba399e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">之前一直对计算机每秒能发出多少个请求没有概念。</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/6f4145b8da284b669fcc7f07f3146be6" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">做爬虫的时候只知道</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">最简单的实现</strong></span><span class="SemanticString">就是在单个线程中发送请求，一个请求结束再发送第二个请求；</span></span></li><li id="https://www.notion.so/c816da566d374790a69a9db2a74327f7" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">如果想要提高每秒的请求量，可以考虑使用</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">多线程</strong></span><span class="SemanticString">，多线程使得我们在等待请求返回值的过程中继续发送新的请求；</span></span></li><li id="https://www.notion.so/5a05711d98a046b98affa797437af526" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">如果想要进一步提高每秒的请求量，可以考虑使用</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">线程池</strong></span><span class="SemanticString">，线程池可以复用已创建好的线程，减少创建、销毁线程的耗时。</span></span></li></ul><div id="https://www.notion.so/49d7efaf1a9d48aab645430ca6d18b5b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">只是感觉每一步的优化都可以提高每秒的请求量，但是对其优化的量级没有直观的理解。于是今天做实验对其进行了测试。</span></span></p></div><h1 id="https://www.notion.so/1ce8d7d328b74ba9b25a3a6f952e8fb1" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/1ce8d7d328b74ba9b25a3a6f952e8fb1"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">实验</span></span></h1><h2 id="https://www.notion.so/d8ed031f68c84d6ab0a48c6d5a8457c6" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/d8ed031f68c84d6ab0a48c6d5a8457c6"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">服务端</span></span></h2><h3 id="https://www.notion.so/1d5536195c9e48f1be7c8310f0ac792f" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/1d5536195c9e48f1be7c8310f0ac792f"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">服务端配置</span></span></h3><div id="https://www.notion.so/ad0a9eb4f1a44449b0b103262ae1a694" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F749f7ad0-b57d-43c4-94b8-4c735b88fb9d%2FUntitled.png?width=1888&amp;table=block&amp;id=ad0a9eb4-f1a4-4449-b0b1-03262ae1a694"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F749f7ad0-b57d-43c4-94b8-4c735b88fb9d%2FUntitled.png?width=1888&amp;table=block&amp;id=ad0a9eb4-f1a4-4449-b0b1-03262ae1a694" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/8a9e032a577b4fbfaa0ece6e7eb02e14" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">如上所示，服务器是字节的火山引擎的云服务器，配置为两核CPU、8GB内存。</span></span></p></div><h3 id="https://www.notion.so/3957cbfc2d574675909be8c28c877aaa" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/3957cbfc2d574675909be8c28c877aaa"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">服务端代码</span></span></h3><div id="https://www.notion.so/7f636b8cf1a84ebd80bf2c01ee6556ef" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">在服务端使用python的Flask框架搭建了一个简单的web服务，代码如下：</span></span></p></div><pre id="https://www.notion.so/1f6aa11ce62749b0947f39b9a276b849" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask
app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/helloworld'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">hello_world</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token string">'Hello, World!'</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">"0.0.0.0"</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">5000</span><span class="token punctuation">)</span></span></span></span></code></pre><h2 id="https://www.notion.so/e29484a32dce430bad2f5cb633df007e" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/e29484a32dce430bad2f5cb633df007e"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">客户端</span></span></h2><div id="https://www.notion.so/ebeeddfb56434c29aa0d9248ecda4fb2" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">客户端代码就是在M1 Mac下运行的</span></span></p></div><h3 id="https://www.notion.so/1ccbd00025544fe1b89d089d12e428ee" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/1ccbd00025544fe1b89d089d12e428ee"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">普通单线程</span></span></h3><div id="https://www.notion.so/2dc69184bddb4f78a95e8cfe2d779c14" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">思路</strong></span></span></p></div><div id="https://www.notion.so/1ad758908a654a28b8e7a72f18cae0a8" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">就是在while中不停执行requests.get方法，一直到while所用的时间间隔超过1秒。</span></span></p></div><div id="https://www.notion.so/eac77847f9594da892ed953d23649f81" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">代码</strong></span></span></p></div><pre id="https://www.notion.so/0fa75c8ef1fe4e98b08ac0f27f0c3410" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">import</span> datetime
<span class="token keyword">import</span> logging
<span class="token keyword">from</span> concurrent<span class="token punctuation">.</span>futures <span class="token keyword">import</span> ThreadPoolExecutor
<span class="token keyword">from</span> threading <span class="token keyword">import</span> Thread

<span class="token keyword">import</span> requests

<span class="token keyword">def</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"http://180.184.69.173:5000/helloworld"</span><span class="token punctuation">)</span>
    <span class="token comment"># logging.info(response.text)</span>

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    logging<span class="token punctuation">.</span>basicConfig<span class="token punctuation">(</span>
        <span class="token builtin">format</span><span class="token operator">=</span><span class="token string">'%(asctime)s %(pathname)s lines: %(lineno)s %(levelname)-8s %(message)s'</span><span class="token punctuation">,</span>
        level<span class="token operator">=</span>logging<span class="token punctuation">.</span>INFO<span class="token punctuation">,</span>
        datefmt<span class="token operator">=</span><span class="token string">'%Y-%m-%d %H:%M:%S'</span><span class="token punctuation">)</span>

    count <span class="token operator">=</span> <span class="token number">0</span>
    start_time <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        fun<span class="token punctuation">(</span><span class="token punctuation">)</span>
        count <span class="token operator">+=</span> <span class="token number">1</span>
        end_time <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
        duration <span class="token operator">=</span> end_time <span class="token operator">-</span> start_time
        logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>duration<span class="token punctuation">.</span>microseconds<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> duration<span class="token punctuation">.</span>seconds <span class="token operator">>=</span> <span class="token number">1</span><span class="token punctuation">:</span>
            <span class="token keyword">break</span>
    logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span>count<span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span></span></span></span></code></pre><div id="https://www.notion.so/7a5ff1ff16e446b69f2e0d73be76dddc" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">实验结果</strong></span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/593d5d38be0f4cf8baa10b7fac8fa965" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">平均1秒可以发送12个请求。</span></span></li></ul><h3 id="https://www.notion.so/9ccdbb8332e347a1a605cd860853617f" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/9ccdbb8332e347a1a605cd860853617f"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">普通多线程</span></span></h3><div id="https://www.notion.so/ca8bf51ec6f24f38a596b8e548958485" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">思路</strong></span></span></p></div><div id="https://www.notion.so/a4d83108742b4c8ab48fac18a793c29c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">就是在while循环中不停创建新线程，并在新线程中执行request.get命令，直到while循环执行的时间大于1秒。</span></span></p></div><div id="https://www.notion.so/3ec9d3fcef19413da06679b13bcfd44f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">代码</strong></span></span></p></div><pre id="https://www.notion.so/1dc6ca3a7e354da0a642d844905cdd36" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">import</span> datetime
<span class="token keyword">import</span> logging
<span class="token keyword">from</span> concurrent<span class="token punctuation">.</span>futures <span class="token keyword">import</span> ThreadPoolExecutor
<span class="token keyword">from</span> threading <span class="token keyword">import</span> Thread

<span class="token keyword">import</span> requests

<span class="token keyword">def</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"http://180.184.69.173:5000/helloworld"</span><span class="token punctuation">)</span>
    <span class="token comment"># logging.info(response.text)</span>

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    logging<span class="token punctuation">.</span>basicConfig<span class="token punctuation">(</span>
        <span class="token builtin">format</span><span class="token operator">=</span><span class="token string">'%(asctime)s %(pathname)s lines: %(lineno)s %(levelname)-8s %(message)s'</span><span class="token punctuation">,</span>
        level<span class="token operator">=</span>logging<span class="token punctuation">.</span>INFO<span class="token punctuation">,</span>
        datefmt<span class="token operator">=</span><span class="token string">'%Y-%m-%d %H:%M:%S'</span><span class="token punctuation">)</span>
    count <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">with</span> ThreadPoolExecutor<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> executor<span class="token punctuation">:</span>
        start_time <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
            thread <span class="token operator">=</span> Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>fun<span class="token punctuation">)</span>
            thread<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
            count <span class="token operator">+=</span> <span class="token number">1</span>
            end_time <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
            duration <span class="token operator">=</span> end_time <span class="token operator">-</span> start_time
            logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span>duration<span class="token punctuation">.</span>microseconds<span class="token punctuation">)</span>
            <span class="token keyword">if</span> duration<span class="token punctuation">.</span>microseconds <span class="token operator">></span> <span class="token number">100_000</span><span class="token punctuation">:</span>
                <span class="token keyword">break</span>
    logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span>count<span class="token punctuation">)</span>
    logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token punctuation">(</span>count <span class="token operator">/</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span></span></span></span></code></pre><div id="https://www.notion.so/02fe55848aa84fcfb7a572a2e23339b3" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">实验结果</strong></span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/4458e11d73324fbdade6a1f196801c52" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">10ms，18个请求。</span></span></li><li id="https://www.notion.so/4f0a4b0715304f2491d2f960101e83e9" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">100ms，182个请求。</span></span></li><li id="https://www.notion.so/6abaa268f119481fa5549047dd37d8c1" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">所以1秒应该大概能发1820个请求。</span></span></li></ul><h3 id="https://www.notion.so/8ab8a1d6caeb4453af881c7bc70fa3a7" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/8ab8a1d6caeb4453af881c7bc70fa3a7"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">线程池</span></span></h3><div id="https://www.notion.so/e1c3dae5d26242f9929f673a320f0fff" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">思路</strong></span></span></p></div><div id="https://www.notion.so/0a6a3ef34320461c92a47b9cc8a4c098" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">也是在while循环中向线程池中提交任务比发出请求。通过引入线程池可以降低线程的创建和销毁所消耗的时间。</span></span></p></div><div id="https://www.notion.so/05356719b889476da8ab99e5b24be5a7" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">代码</strong></span></span></p></div><pre id="https://www.notion.so/96bc8d4369d44060967931806985204d" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">import</span> datetime
<span class="token keyword">import</span> logging
<span class="token keyword">import</span> time
<span class="token keyword">from</span> concurrent<span class="token punctuation">.</span>futures <span class="token keyword">import</span> ThreadPoolExecutor

<span class="token keyword">import</span> requests


<span class="token keyword">def</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"http://180.184.69.173:5000/helloworld"</span><span class="token punctuation">)</span>
    <span class="token comment"># logging.info(response.text)</span>


<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    logging<span class="token punctuation">.</span>basicConfig<span class="token punctuation">(</span>
        <span class="token builtin">format</span><span class="token operator">=</span><span class="token string">'%(asctime)s %(pathname)s lines: %(lineno)s %(levelname)-8s %(message)s'</span><span class="token punctuation">,</span>
        level<span class="token operator">=</span>logging<span class="token punctuation">.</span>INFO<span class="token punctuation">,</span>
        datefmt<span class="token operator">=</span><span class="token string">'%Y-%m-%d %H:%M:%S'</span><span class="token punctuation">)</span>
    count <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">with</span> ThreadPoolExecutor<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> executor<span class="token punctuation">:</span>
        start_time <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
            executor<span class="token punctuation">.</span>submit<span class="token punctuation">(</span>fun<span class="token punctuation">)</span>
            count <span class="token operator">+=</span> <span class="token number">1</span>
            end_time <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
            duration <span class="token operator">=</span> end_time <span class="token operator">-</span> start_time
            logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span>duration<span class="token punctuation">.</span>microseconds<span class="token punctuation">)</span>
            <span class="token keyword">if</span> duration<span class="token punctuation">.</span>microseconds <span class="token operator">></span> <span class="token number">10_000</span><span class="token punctuation">:</span>
                <span class="token keyword">break</span>
    logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span>count<span class="token punctuation">)</span>
    logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token punctuation">(</span>count <span class="token operator">/</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span></span></span></span></code></pre><div id="https://www.notion.so/6d3d4c08880c46d8b869090278148d16" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">实验结果</strong></span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/54a3352c90a849559339bd11b4cbe700" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">10ms，146个请求。</span></span></li><li id="https://www.notion.so/10ff0a92a51948439f6a6c6037ecced6" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">于是可以推测：1s可以发出14600（一万四千六百）个请求。</span></span></li></ul><h3 id="https://www.notion.so/ae8d3f0b529a4e049a7ef81c6e1c5ae6" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/ae8d3f0b529a4e049a7ef81c6e1c5ae6"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">线程池+</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">测试百度</strong></span></span></h3><div id="https://www.notion.so/8f739cd61e4f4a24a2f9f5d7c9045a23" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">思路</strong></span></span></p></div><div id="https://www.notion.so/35db79b56749415bbb856f2d86e40c87" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">为了排除返回内容太简单（只有一个Hello World）对结果的影响，于是又对百度进行了测试。</span></span></p></div><div id="https://www.notion.so/377ecb56458643f8a2c16c5070196a29" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">代码</strong></span></span></p></div><pre id="https://www.notion.so/bb6060c39fec479b8f62f6719528046a" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">import</span> datetime
<span class="token keyword">import</span> logging
<span class="token keyword">import</span> time
<span class="token keyword">from</span> concurrent<span class="token punctuation">.</span>futures <span class="token keyword">import</span> ThreadPoolExecutor
<span class="token keyword">import</span> requests

<span class="token keyword">def</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"https://www.baidu.com"</span><span class="token punctuation">)</span>
    <span class="token comment"># logging.info(response.text)</span>

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    logging<span class="token punctuation">.</span>basicConfig<span class="token punctuation">(</span>
        <span class="token builtin">format</span><span class="token operator">=</span><span class="token string">'%(asctime)s %(pathname)s lines: %(lineno)s %(levelname)-8s %(message)s'</span><span class="token punctuation">,</span>
        level<span class="token operator">=</span>logging<span class="token punctuation">.</span>INFO<span class="token punctuation">,</span>
        datefmt<span class="token operator">=</span><span class="token string">'%Y-%m-%d %H:%M:%S'</span><span class="token punctuation">)</span>
    count <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">with</span> ThreadPoolExecutor<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> executor<span class="token punctuation">:</span>
        start_time <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
            executor<span class="token punctuation">.</span>submit<span class="token punctuation">(</span>fun<span class="token punctuation">)</span>
            count <span class="token operator">+=</span> <span class="token number">1</span>
            end_time <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
            duration <span class="token operator">=</span> end_time <span class="token operator">-</span> start_time
            logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span>duration<span class="token punctuation">.</span>microseconds<span class="token punctuation">)</span>
            <span class="token keyword">if</span> duration<span class="token punctuation">.</span>microseconds <span class="token operator">></span> <span class="token number">10_000</span><span class="token punctuation">:</span>
                <span class="token keyword">break</span>
    logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span>count<span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span></span></span></span></code></pre><div id="https://www.notion.so/78aef82fd3374f7a87658b73d251eb8d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">实验结果</strong></span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/285d7673f85f408e9eb111082c442677" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">10ms，152个请求</span></span></li><li id="https://www.notion.so/b4ddbc8cb5594195a8221127898e3c5e" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">跟上面的实验结果差别不大。</span></span></li></ul><h3 id="https://www.notion.so/b5cbbb2960e3415593f7adb699ed45d8" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/b5cbbb2960e3415593f7adb699ed45d8"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">线程池+socket构造请求</span></span></h3><div id="https://www.notion.so/88df7794ac8d46e08e48615220c24278" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">思路</strong></span></span></p></div><div id="https://www.notion.so/e0b271bef74042a2b96f8b893621d2a6" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">在每个线程中直接使用socket来构造HTTP请求，并接收HTTP相应。来进一步压缩每个线程的工作量，增加每秒发出的请求数。</span></span></p></div><div id="https://www.notion.so/7306ced9e2b14519becd63e6df1c1e0b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">代码</strong></span></span></p></div><pre id="https://www.notion.so/370ce9c59d2a40aab34956bf87dfdb5b" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">import</span> datetime
<span class="token keyword">import</span> logging
<span class="token keyword">import</span> socket
<span class="token keyword">from</span> concurrent<span class="token punctuation">.</span>futures <span class="token keyword">import</span> ThreadPoolExecutor
<span class="token keyword">from</span> threading <span class="token keyword">import</span> Thread

content <span class="token operator">=</span> <span class="token triple-quoted-string string">"""GET /helloworld HTTP/1.1
Host: 180.184.69.173

"""</span>

<span class="token keyword">def</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    s <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>

    s<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"180.184.69.173"</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    s<span class="token punctuation">.</span>send<span class="token punctuation">(</span>content<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># s.recv(1024).decode()</span>
    s<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    logging<span class="token punctuation">.</span>basicConfig<span class="token punctuation">(</span>
        <span class="token builtin">format</span><span class="token operator">=</span><span class="token string">'%(asctime)s %(pathname)s lines: %(lineno)s %(levelname)-8s %(message)s'</span><span class="token punctuation">,</span>
        level<span class="token operator">=</span>logging<span class="token punctuation">.</span>INFO<span class="token punctuation">,</span>
        datefmt<span class="token operator">=</span><span class="token string">'%Y-%m-%d %H:%M:%S'</span><span class="token punctuation">)</span>
    count <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">with</span> ThreadPoolExecutor<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> executor<span class="token punctuation">:</span>
        start_time <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
            thread <span class="token operator">=</span> Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>fun<span class="token punctuation">)</span>
            thread<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
            count <span class="token operator">+=</span> <span class="token number">1</span>
            end_time <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
            duration <span class="token operator">=</span> end_time <span class="token operator">-</span> start_time
            logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span>duration<span class="token punctuation">.</span>microseconds<span class="token punctuation">)</span>
            <span class="token keyword">if</span> duration<span class="token punctuation">.</span>microseconds <span class="token operator">></span> <span class="token number">10_000</span><span class="token punctuation">:</span>
                <span class="token keyword">break</span>
    logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span>count<span class="token punctuation">)</span>
    logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token punctuation">(</span>count <span class="token operator">/</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span></span></span></span></code></pre><div id="https://www.notion.so/7aad64e459224e6e8414d9ceee1afe1f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">实验结果</strong></span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/b570519d94934270bfa6fc3d4b1bc2c0" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">10ms，137个请求。</span></span></li><li id="https://www.notion.so/91b33600def84a05a97aabeab2c8c5ba" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">于是1秒大概可以发送13700个请求。与requests+线程池相比差别不大。</span></span></li></ul><h3 id="https://www.notion.so/cb4646b6764648cabc4073b5c59ea45d" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/cb4646b6764648cabc4073b5c59ea45d"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">仅使用socket（不使用多线程）</span></span></h3><div id="https://www.notion.so/a4692ae54e114bf0b80db4fa40111fb6" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">代码</strong></span></span></p></div><pre id="https://www.notion.so/4a69f8d86fab4746bbf21def2d6b097c" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">import</span> datetime
<span class="token keyword">import</span> logging
<span class="token keyword">import</span> socket
<span class="token keyword">from</span> concurrent<span class="token punctuation">.</span>futures <span class="token keyword">import</span> ThreadPoolExecutor
<span class="token keyword">from</span> threading <span class="token keyword">import</span> Thread

content <span class="token operator">=</span> <span class="token triple-quoted-string string">"""GET /helloworld HTTP/1.1
Host: 180.184.69.173

"""</span>

<span class="token keyword">def</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    s <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>

    s<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"180.184.69.173"</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    s<span class="token punctuation">.</span>send<span class="token punctuation">(</span>content<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># s.recv(1024).decode()</span>
    s<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    logging<span class="token punctuation">.</span>basicConfig<span class="token punctuation">(</span>
        <span class="token builtin">format</span><span class="token operator">=</span><span class="token string">'%(asctime)s %(pathname)s lines: %(lineno)s %(levelname)-8s %(message)s'</span><span class="token punctuation">,</span>
        level<span class="token operator">=</span>logging<span class="token punctuation">.</span>INFO<span class="token punctuation">,</span>
        datefmt<span class="token operator">=</span><span class="token string">'%Y-%m-%d %H:%M:%S'</span><span class="token punctuation">)</span>
    count <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">with</span> ThreadPoolExecutor<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> executor<span class="token punctuation">:</span>
        start_time <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
            fun<span class="token punctuation">(</span><span class="token punctuation">)</span>
            count <span class="token operator">+=</span> <span class="token number">1</span>
            end_time <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
            duration <span class="token operator">=</span> end_time <span class="token operator">-</span> start_time
            logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span>duration<span class="token punctuation">.</span>microseconds<span class="token punctuation">)</span>
            <span class="token keyword">if</span> duration<span class="token punctuation">.</span>microseconds <span class="token operator">></span> <span class="token number">10_000</span><span class="token punctuation">:</span>
                <span class="token keyword">break</span>
    logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span>count<span class="token punctuation">)</span>
    logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token punctuation">(</span>count <span class="token operator">/</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span></span></span></span></code></pre><div id="https://www.notion.so/b2aa287c69184617b459933da6388346" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">实验结果</strong></span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/a3f94c1356f24313b02baf5e32af0fe8" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">100ms，5个请求。</span></span></li><li id="https://www.notion.so/898eef99a82545a1ba031205c7586e20" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">于是1秒大概可以发出5个请求。</span></span></li></ul><h3 id="https://www.notion.so/7c717135188f4105958e31b2cf681c51" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/7c717135188f4105958e31b2cf681c51"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">在一个socket中发送多个HTTP请求</span></span></h3><div id="https://www.notion.so/1cdb29b5f5d74d5daaae326ac4bdd486" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">思路</strong></span></span></p></div><div id="https://www.notion.so/8057cb1b85b8458fbbce2dcde3edd2cc" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">创建socket之后，不停调用其send方法来发送请求。</span></span></p></div><div id="https://www.notion.so/f4d87b5f0d5541f58b1fbaa6e484d902" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">代码实现</strong></span></span></p></div><div id="https://www.notion.so/1f489788e13a426c9a7c3e3176e14e40" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">这种方式需要客户端和服务端都支持长链接，服务端代码需要修改为</span></span></p></div><pre id="https://www.notion.so/ad947a9c6af74165a7b01b4a07234375" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask
<span class="token keyword">from</span> werkzeug<span class="token punctuation">.</span>serving <span class="token keyword">import</span> WSGIRequestHandler
app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/helloworld'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">hello_world</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token string">'Hello, World!'</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    WSGIRequestHandler<span class="token punctuation">.</span>protocol_version <span class="token operator">=</span> <span class="token string">"HTTP/1.1"</span>
    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">"0.0.0.0"</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">5000</span><span class="token punctuation">)</span></span></span></span></code></pre><div id="https://www.notion.so/7e3c6de43df146f1a603096f76718493" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">客户端代码为</span></span></p></div><pre id="https://www.notion.so/751e2b9da6c6470a9ac9568408961542" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">import</span> datetime
<span class="token keyword">import</span> logging
<span class="token keyword">import</span> socket
<span class="token keyword">from</span> concurrent<span class="token punctuation">.</span>futures <span class="token keyword">import</span> ThreadPoolExecutor
<span class="token keyword">from</span> threading <span class="token keyword">import</span> Thread

content <span class="token operator">=</span> <span class="token triple-quoted-string string">"""GET /helloworld HTTP/1.1
Host: 180.184.69.173
Connection: keep-alive
Keep-Alive: timeout=5, max=1000

"""</span>


<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    logging<span class="token punctuation">.</span>basicConfig<span class="token punctuation">(</span>
        <span class="token builtin">format</span><span class="token operator">=</span><span class="token string">'%(asctime)s %(pathname)s lines: %(lineno)s %(levelname)-8s %(message)s'</span><span class="token punctuation">,</span>
        level<span class="token operator">=</span>logging<span class="token punctuation">.</span>INFO<span class="token punctuation">,</span>
        datefmt<span class="token operator">=</span><span class="token string">'%Y-%m-%d %H:%M:%S'</span><span class="token punctuation">)</span>
    count <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">with</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span> <span class="token keyword">as</span> s<span class="token punctuation">:</span>
        s<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"180.184.69.173"</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        start_time <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
            s<span class="token punctuation">.</span>send<span class="token punctuation">(</span>content<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            count <span class="token operator">+=</span> <span class="token number">1</span>
            end_time <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
            duration <span class="token operator">=</span> end_time <span class="token operator">-</span> start_time
            logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span>duration<span class="token punctuation">.</span>microseconds<span class="token punctuation">)</span>
            <span class="token keyword">if</span> duration<span class="token punctuation">.</span>microseconds <span class="token operator">></span> <span class="token number">100_000</span><span class="token punctuation">:</span>
                <span class="token keyword">break</span>
    logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span>count<span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span></span></span></span></code></pre><div id="https://www.notion.so/271aacb0bae84b15b747494a33e28b48" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">实验结果</strong></span></span></p></div><div id="https://www.notion.so/82b3e63698de4793bbb0d6feaf626782" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">10ms，153个请求</span></span></p></div><div id="https://www.notion.so/9a5d22b350264b5b82c8782ebfcac165" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">100ms，804个请求</span></span></p></div><div id="https://www.notion.so/28029294b10c408a96d16848a81b48d1" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">于是可以推测1秒可以发送近一万个请求</span></span></p></div><h1 id="https://www.notion.so/09a65e64ad2948e287592fa6a9490b23" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/09a65e64ad2948e287592fa6a9490b23"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">总结</span></span></h1><div id="https://www.notion.so/de50d9eea44a40e2ab122adb05d758ba" class="CollectionInline"><h3><a class="Anchor" href="#https://www.notion.so/de50d9eea44a40e2ab122adb05d758ba"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">实验结果对照</span></span></h3><div class="Table"><table><thead><tr><th style="width:276px">实验名称</th><th>每秒的请求数</th></tr></thead><tbody><tr><td class="Table__CellTitle"><a href="https://www.notion.so/86ffd18ef237455e9d1bb62360ed123c"><span class="SemanticStringArray"><span class="SemanticString">普通单线程</span></span></a></td><td class="Table__CellText"><span class="SemanticStringArray"><span class="SemanticString">12</span></span></td></tr><tr><td class="Table__CellTitle"><a href="https://www.notion.so/cf9dd3c94be24e5f96520484a2ea933c"><span class="SemanticStringArray"><span class="SemanticString">普通多线程</span></span></a></td><td class="Table__CellText"><span class="SemanticStringArray"><span class="SemanticString">1820</span></span></td></tr><tr><td class="Table__CellTitle"><a href="https://www.notion.so/865b524f51c8498d8f5589575b555b8e"><span class="SemanticStringArray"><span class="SemanticString">线程池</span></span></a></td><td class="Table__CellText"><span class="SemanticStringArray"><span class="SemanticString">14600</span></span></td></tr><tr><td class="Table__CellTitle"><a href="https://www.notion.so/1af5fa307a754431998e7b61c307d374"><span class="SemanticStringArray"><span class="SemanticString">线程池+测试百度</span></span></a></td><td class="Table__CellText"><span class="SemanticStringArray"><span class="SemanticString">15200</span></span></td></tr><tr><td class="Table__CellTitle"><a href="https://www.notion.so/576584e649954e26a795f76a017d6527"><span class="SemanticStringArray"><span class="SemanticString">线程池+socket</span></span></a></td><td class="Table__CellText"><span class="SemanticStringArray"><span class="SemanticString">13700</span></span></td></tr><tr><td class="Table__CellTitle"><a href="https://www.notion.so/7957544e1f31411398c7bb1f4b711387"><span class="SemanticStringArray"><span class="SemanticString">单线程+socket</span></span></a></td><td class="Table__CellText"><span class="SemanticStringArray"><span class="SemanticString">5</span></span></td></tr><tr><td class="Table__CellTitle"><a href="https://www.notion.so/1c98651f86f2423b873c95ba53c6fe49"><span class="SemanticStringArray"><span class="SemanticString">一个socket+长连接</span></span></a></td><td class="Table__CellText"><span class="SemanticStringArray"><span class="SemanticString">15300</span></span></td></tr></tbody></table></div></div><div id="https://www.notion.so/c1c01fd678044de18c0d92e0464a3b2e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">可以看到，只要用了线程池，不管requests还是sockets每秒都能发送上万个请求，使用单个socket+HTTP长连接每秒也能发送上万个请求。</span></span></p></div></article>
  <script src="https://utteranc.es/client.js"
    repo="shaojunying/shaojunying.github.io"
    issue-term="title"
    label="Comment"
    theme="github-light"
    crossorigin="anonymous"
    async>
  </script>
  <footer class="Footer">
  <div>&copy; Junying Shao&#39;s Blog 2019-2021</div>
  <div>&centerdot;</div>
  <div>Powered by <a href="https://github.com/dragonman225/notablog" target="_blank"
      rel="noopener noreferrer">Notablog</a>.
  </div>
</footer>
</body>

</html>