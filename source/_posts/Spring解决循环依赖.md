---
title: Spring解决循环依赖
date: 2021-04-04 14:09:29
tags:
---
> [跳出源码地狱，Spring巧用三级缓存解决循环依赖-原理篇-Java知音](https://www.javazhiyin.com/70070.html)

## 概述

使用两级缓存即可解决循环依赖问题，但是Spring还需要支持AOP，对象被AOP之后会生成一个新的对象，如果在将实例注入之后再进行AOP，那么两个地方的对象将不一致。因此使用三级缓存，将对象的AOP提前到实例化进行。

## 三级缓存的过程

1. 尝试获取一个bean，发现bean不存在，于是实例化该bean，并放入三级缓存。
2. 第二次尝试获取该bean，从三级缓存中找到bean，对该实例执行AOP，放入二级缓存并返回。
3. 在初始化工作彻底完成之后，Spring将bean放入一级缓存，并从二三级缓存中删除。